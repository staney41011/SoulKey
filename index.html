function renderPage(data) {
      document.getElementById('loading').style.display = 'none';
      document.getElementById('main-content').style.display = 'block';
      
      // --- 【更新標題區域】 ---
      let titleText = "打開心靈的鎖匙"; // 預設標題
      let subText = "週週打開心靈的鎖匙課程 DM"; // 預設副標題

      // 如果有期數
      if (data.period) {
        titleText = `第 ${data.period} 期 - 打開心靈的鎖匙`;
      }

      // 如果有日期
      if (data.date) {
        // 將日期加在副標題後面，或者您想加在標題也可以
        subText += ` (${data.date})`;
      }

      // 更新畫面文字
      document.getElementById('page-title').innerText = titleText;
      document.querySelector('.header-banner p').innerText = subText;
      // -----------------------

      const container = document.getElementById('cards-container');
      let html = '';

      if (!data.items || data.items.length === 0) {
        container.innerHTML = '<div class="alert alert-warning text-center">無圖片資料。</div>';
        return;
      }

      data.items.forEach(item => {
        // 分享時的文字也加入日期
        const shareTitle = `打開心靈的鎖匙 ${titleText} ${data.date || ""} ${item.lang}版 DM`;
        
        // GitHub 圖片完整網址
        const imgUrl = `https://${USERNAME}.github.io/${REPO}/${item.imageUrl}`;

        html += `
          <div class="col-md-6 col-lg-4">
            <div class="card h-100">
              <div class="card-header d-flex justify-content-between align-items-center">
                <div><i class="fas fa-language me-2 text-success"></i>${item.lang}版</div>
              </div>
              <div class="card-body p-0">
                  <div class="img-wrapper">
                    <img src="${imgUrl}" class="img-fluid" alt="${item.lang}">
                  </div>
              </div>
              <div class="card-body pt-0 pb-3 px-3">
                ${navigator.share ? `
                <button onclick="shareImage('${shareTitle}', '${imgUrl}')" class="btn btn-line btn-action">
                  <i class="fab fa-line me-2"></i> 分享圖片到 LINE
                </button>
                ` : ''}
                <a href="${imgUrl}" download="${item.lang}_DM.png" class="btn btn-outline-success btn-sm btn-download btn-action">
                  <i class="fas fa-download me-2"></i> 下載圖片
                </a>
              </div>
              <div class="card-footer bg-light text-muted small text-center py-2">
                ${item.lang}版 DM
              </div>
            </div>
          </div>
        `;
      });
      container.innerHTML = html;
    }
